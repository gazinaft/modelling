<h1>Звіт
з лабораторної роботи  № 3 з дисципліни
«Моделювання систем»
</h1>

# «ПОБУДОВА ІМІТАЦІЙНОЇ МОДЕЛІ СИСТЕМИ З ВИКОРИСТАННЯМ ФОРМАЛІЗМУ МОДЕЛІ МАСОВОГО ОБСЛУГОВУВАННЯ»

## Виконав: ІП-91 Газін Костянтин

[//]: # ()
[//]: # ()
## Перевірив: Дифучин Антон Юрійович


# Зміст
1) [Завдання](#Завдання)
2) [Виконання](#Виконання)
3) [Висновок](#Висновок)
4) [Додаток 1](#Додаток-1)

# Завдання 
1. Реалізувати універсальний алгоритм імітації моделі масового
   обслуговування з багатоканальним обслуговуванням, з вибором
   маршруту за пріоритетом або за заданою ймовірністю. 30 балів.
2. Для наступного тексту задачі скласти формалізовану модель масового
   обслуговування та реалізувати її з використанням побудованого
   універсального алгоритму (30 балів):
   У банку для автомобілістів є два віконця, кожне з яких
   обслуговується одним касиром і має окрему під'їзну смугу. Обидві смуги
   розташовані поруч. З попередніх спостережень відомо, що інтервали часу
   між прибуттям клієнтів у годину пік розподілені експоненційно з
   математичним очікуванням, рівним 0,5 од. часу. Через те, що банк буває
   переобтяжений тільки в годину пік, то аналізується тільки цей період.
   Тривалість обслуговування в обох касирів однакова і розподілена
   експоненційно з математичним очікуванням, рівним 0,3 од. часу. Відомо
   також, що при рівній довжині черг, а також при відсутності черг, клієнти
   віддають перевагу першій смузі. В усіх інших випадках клієнти
   вибирають більш коротку чергу. Після того, як клієнт в'їхав у банк, він не
   може залишити його, доки не буде обслугований. Проте він може
   перемінити чергу, якщо стоїть останнім і різниця в довжині черг при
   цьому складає не менше двох автомобілів. Через обмежене місце на
   кожній смузі може знаходитися не більш трьох автомобілів. У банку,
   таким чином, не може знаходитися більш восьми автомобілів, включаючи
   автомобілі двох клієнтів, що обслуговуються в поточний момент
   касиром. Якщо місце перед банком заповнено до границі, то клієнт, що
   прибув, вважається втраченим, тому що він відразу ж виїжджає.
   Початкові умови такі: 1) обидва касири зайняті, тривалість
   обслуговування для кожного касира нормально розподілена з
   математичним очікуванням, рівним 1 од. часу, і середньоквадратичним
   відхиленням, рівним 0,3 од. часу; 2) прибуття першого клієнта
   заплановано на момент часу 0,1 од. часу; 3) у кожній черзі очікують по
   два автомобіля.
   Визначити такі величини: 1) середнє завантаження кожного касира; 2) середнє число клієнтів у банку; 3) середній інтервал часу між
   від'їздами клієнтів від вікон; 4) середній час перебування клієнта в банку; 5) середнє число клієнтів у кожній черзі; 6) відсоток клієнтів, яким
   відмовлено в обслуговуванні; 7) число змін під'їзних смуг.
3. Для наступного тексту задачі скласти формалізовану модель масового
   обслуговування та реалізувати її з використанням побудованого
   універсального алгоритму (40 балів):
   У лікарню поступають хворі таких трьох типів: 1) хворі, що
   пройшли попереднє обстеження і направлені на лікування; 2) хворі, що
   бажають потрапити в лікарню, але не пройшли повністю попереднє
   обстеження; 3) хворі, які тільки що поступили на попереднє обстеження.
   Чисельні характеристики типів хворих наведені в таблиці:

   | Тип хворого | Відносна частота | Середній час реєстрації, хв |
   |-------------|------------------|-----------------------------|
   | 1           | 0,5              | 15               |
   | 2           | 0,1              | 40               |
   | 3           | 0,4              | 30               |

   При надходженні в приймальне відділення хворий стає в чергу,
   якщо обидва чергових лікарі зайняті. Лікар, який звільнився, вибирає в
   першу чергу тих хворих, що вже пройшли попереднє обстеження. Після
   заповнення різноманітних форм у приймальне відділення хворі 1 типу
   ідуть прямо в палату, а хворі типів 2 і 3 направляються в лабораторію.
   Троє супровідних розводять хворих по палатах. Хворим не дозволяється
   направлятися в палату без супровідного. Якщо всі супровідні зайняті,
   хворі очікують їхнього звільнення в приймальному відділенні. Як тільки
   хворий доставлений у палату, він вважається таким, що завершив процес
   прийому до лікарні.
   Хворі, що спрямовуються в лабораторію, не потребують супроводу.
   Після прибуття в лабораторію хворі стають у чергу в реєстратуру. Після
   реєстрації вони ідуть у кімнату очікування, де чекають виклику до одного
   з двох лаборантів. Після здачі аналізів хворі або повертаються в
   приймальне відділення (якщо їх приймають у лікарню), або залишають
   лікарню (якщо їм було призначено тільки попереднє обстеження). Після
   повернення в приймальне відділення хворий, що здав аналізи,
   розглядається як хворий типу 1.
   У наступній таблиці приводяться дані по тривалості дій (хв):
   
   | Величина                                   | Розподіл                                       |
   |------------------------------------------------|--------------|
   | Час між прибуттями в приймальне відділення | Експоненціальний з математичним сподіванням 15 |
   | Час слідування в палату | Рівномірне від 3 до 8                          |
   | Час слідування з приймального відділення в лабораторію або з лабораторії в приймальне відділення | Рівномірне від 2 до 5                          |
   | Час обслуговування в реєстратуру лабораторії | Ерланга з математичним сподіванням 4,5 і k=3   |
   | Час проведення аналізу в лабораторії | Ерланга з математичним сподіванням 4 і k=2 |

   Визначити час, проведений хворим у системі, тобто інтервал часу,
   починаючи з надходження і закінчуючи доставкою в палату (для хворих
   типу 1 і 2) або виходом із лабораторії (для хворих типу 3). Визначити
   також інтервал між прибуттями хворих у лабораторію.

# Виконання

## 1. Універсальний алгоритм імітації
Виконано у минулій лабораторній роботі
## 2. Банк
Для реалізації банку треба було трохи модифікувати Process, для
зміни черг і підрахунку потрібної статистики.
### `SwichingProcess.java`
```java
package bank;

import simsimple.Process;

public class SwitchingProcess extends Process {

    public int priority;
    private int switchedCount;
    public double sum_time_to_go;
    private SwitchingProcess other;

    public SwitchingProcess(double delay, int channels_max, int priority) {
        super(delay, channels_max);
        this.priority = priority;

        switchedCount = 0;
    }

    public void initPair(SwitchingProcess other) {
        this.other = other;
        other.other = this;
    }

    @Override
    public void putMinimal(double next) {
        sum_time_to_go += next - getTcurr();
        super.putMinimal(next);
    }

    @Override
    public void outAct() {
        super.outAct();
        switchFromAnother();
    }

    // use when process done with a car
    public void switchFromAnother() {
        if (other.queue - this.queue >= 2) {
            this.queue++;
            other.queue--;
            switchedCount++;
        }
    }

    @Override
    public void printInfo() {
        super.printInfo();
        System.out.println("Switched to this line = " + switchedCount);
    }
}

```

# Висновок
Ми реалізували універсальний алгоритм імітації та на практиці закріпили вміння
проектувати мережі масового обслуговування і з мінімальними змінами вирішувати
поставлену задачу.